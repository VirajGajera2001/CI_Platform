@{var name = Context.Session.GetString("FName");}
@using Newtonsoft.Json;

@{
    var jsoncity=ViewBag.City;
    var mycity = JsonConvert.DeserializeObject<List<CitydataModel>>(jsoncity);
    var jsoncountry = ViewBag.Country;
    var mycountry = JsonConvert.DeserializeObject<List<CountrydataModel>>(jsoncountry);
    var jsontheme = ViewBag.Themes;
    var mytheme = JsonConvert.DeserializeObject<List<ThemedataModel>>(jsontheme);
}
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link rel="stylesheet" href="../CSS/landing.css" />
        <link rel="stylesheet" href="../Bootstrap/css/bootstrap.min.css" />
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg">
            <div class="container-fluid">
                <div class="hambarger col-lg-2 col-md-6">
                    <button class="btn btn-outline-dark hambarger"
                            type="button"
                            data-bs-toggle="offcanvas"
                            data-bs-target="#offcanvasBottom"
                            aria-controls="offcanvasBottom">
                        <span class="navbar-toggler-icon">
                            <img src="../CI-Imgs/menu-bar.svg" alt="" />
                        </span>
                    </button>
                    <div class="offcanvas offcanvas-start offcanvahambarger"
                         tabindex="-1"
                         id="offcanvasBottom"
                         aria-labelledby="offcanvasBottomLabel">
                        <div class="offcanvas-header">
                            <h5 class="offcanvas-title" id="offcanvasBottomLabel">
                                Offcanvas bottom
                            </h5>
                            <button type="button"
                                    class="btn-close text-reset"
                                    data-bs-dismiss="offcanvas"
                                    aria-label="Close">
                            </button>
                        </div>
                        <div class="offcanvas-body small">
                            <div class="downbox ms-2">
                                <a asp-controller="Home" asp-action="Story_Listing" class="text-decoration-none" style="color: black">
                                    Story
                                </a>
                            </div>
                            <div class="dropdown mt-2">
                                <div class="downbox">
                                    <select data-bs-toggle="drop-down" class="form-control form-select border-0">
                                        <option value="">Policy</option>
                                        <option value="">Policy1</option>
                                        <option value="">Policy2</option>
                                        <option value="">Policy3</option>
                                    </select>
                                </div>
                            </div>
                            <div class="dropdown mt-2">
                                <div class="downbox">
                                    <select data-bs-toggle="drop-down" class="form-control form-select border-0">
                                        <option value="">Country</option>
                                        <option value="">Policy1</option>
                                        <option value="">Policy2</option>
                                        <option value="">Policy3</option>
                                    </select>
                                </div>
                            </div>
                            <div class="dropdown mt-2">
                                <div class="downbox">
                                    <select data-bs-toggle="drop-down" class="form-control form-select border-0">
                                        <option value="">City</option>
                                        <option value="">Policy1</option>
                                        <option value="">Policy2</option>
                                        <option value="">Policy3</option>
                                    </select>
                                </div>
                            </div>
                            <div class="dropdown mt-2">
                                <div class="downbox">
                                    <select data-bs-toggle="drop-down" class="form-control form-select border-0">
                                        <option value="">Theme</option>
                                        <option value="">Policy1</option>
                                        <option value="">Policy2</option>
                                        <option value="">Policy3</option>
                                    </select>
                                </div>
                            </div>
                            <div class="dropdown mt-2">
                                <div class="downbox">
                                    <select data-bs-toggle="drop-down" class="form-control form-select border-0">
                                        <option value="">Skills</option>
                                        <option value="">Policy1</option>
                                        <option value="">Policy2</option>
                                        <option value="">Policy3</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-10 col-md-6 mid">
                    <div class="story profitext">
                        <a asp-controller="Home" asp-action="Story_Listing" class="text-decoration-none" style="color: black;">Story</a>
                    </div>
                    <div class="policy ms-5 profitext">
                        <select name="" id="" class="border-0">
                            <option value="">Policy</option>
                            <option value="">Policy1</option>
                            <option value="">Policy2</option>
                            <option value="">Policy3</option>
                        </select>
                    </div>
                    <div class="profile d-flex ms-auto">
                        <img src="../CI-Imgs/bell.png" alt="" class="bell ms-auto">
                        <div class="dropdown">
                            <button class="border-0 bg-white" type="button" data-bs-toggle="dropdown">
                                <img src="../CI-Imgs/user-img.png" class="profileimg">
                            @{
                                if (@name != null)
                                {
                                    <span>@name</span>
                                }
                            }
                                <img src="../CI-Imgs/drop-down.png" class="ic-down">
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">My Profile</a></li>
                                <li><a class="dropdown-item" href="#">Help</a></li>
                                <li><a class="dropdown-item" asp-controller="Login" asp-action="Login">Logout</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                </div>
        </nav>
        <nav class="navbar navbar-expand-lg secondnav p-0">
            <div class="row container-fluid p-0">
                <div class="col-md-4 d-flex col-lg-8">
                    <img src="../CI-Imgs/search.png" alt="" class="searchico mt-2 ms-3">
                    <input type="text" class="form-control border-0" placeholder="Search mission..." id="filter-input" />
                </div>
                <div class="col-md-2 country col-lg-1 p-0">
                    <div class="dropdown downs">
                        <button class="bg-white border-0" type="button" data-bs-toggle="dropdown">
                            <span>Country</span>
                            <img src="../CI-Imgs/drop-down.png" class="ic-down">
                        </button>
                        <ul class="dropdown-menu showing">
                        @foreach(var item in mycountry){
                        
                            <li>
                                <input class="form-check-input Checkme" type="checkbox" name=@item.Name value=@item.CountryId />@item.Name
                            </li>
                        
                        }
                    </ul>
                    </div>
                </div>
                <div class="col-md-2 city col-lg-1 p-0">
                    <div class="dropdown downs">
                        <button class="bg-white border-0" type="button" data-bs-toggle="dropdown">
                            <span>City</span>
                            <img src="../CI-Imgs/drop-down.png" class="ic-down">
                        </button>
                        <ul class="dropdown-menu showing">
                        @foreach (var item in mycity)
                        {
                            <li>
                            <input class="form-check-input Checkme" type="checkbox" value=@item.CityId name=@item.Name />
                            @item.Name
                            </li>
                            }
                        </ul>
                    </div>
                </div>
                
                <div class="col-md-2 theme col-lg-1 p-0">
                    <div class="dropdown downs">
                        <button class="bg-white border-0" type="button" data-bs-toggle="dropdown">
                            <span>Theme</span>
                            <img src="../CI-Imgs/drop-down.png" class="ic-down">
                        </button>
                        <ul class="dropdown-menu showing">
                            @foreach(var item in mytheme){
                            <li>
                                <input class="form-check-input Checkme" type="checkbox" value=@item.MissionThemeId name=@item.Title/>@item.Title
                            </li>
                        }
                        </ul>
                    </div>
                </div>
                <div class="col-md-2 skills col-lg-1 p-0">
                    <div class="dropdown downs">
                        <button class="bg-white border-0" type="button" data-bs-toggle="dropdown">
                            Skills
                            <img src="../CI-Imgs/drop-down.png" class="ic-down">
                        </button>
                        <ul class="dropdown-menu">
                            <li>
                                <input class="form-check-input Checkme" type="checkbox" value="Skill1" />Skill1
                            </li>
                            <li>
                                <input class="form-check-input Checkme" type="checkbox" value="Skill2" />Skill2
                            </li>
                            <li>
                                <input class="form-check-input Checkme" type="checkbox" value="Skill3" />Skill3
                            </li>
                            <li>
                                <input class="form-check-input Checkme" type="checkbox" value="Skill3" />Skill3
                            </li>
                            <li>
                                <input class="form-check-input Checkme" type="checkbox" value="Skill3" />Skill3
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
        <div class="container">
            <div class="row">
                <button id="clearBtn" class="clear-button mt-1">Clear All</button>
                <div class="col-12">
                    <ul class="filtersection d-flex mt-2 flex-wrap">
                    </ul>
                </div>
            </div>
        </div>
        <div class="container mt-5">
            <div class="row">
                <div class="col-md-12 d-flex p-0">
                    <h4 class="text-muted">Explore</h4>
                    <h3 class="ms-2" id="list-count"><b></b></h3>
                    <div class="ms-auto">
                    <div class="dropdown downs">
                        <button class="bg-white border-0" type="button" data-bs-toggle="dropdown">
                            Skills
                            <img src="../CI-Imgs/drop-down.png" class="ic-down">
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="sortNewest()">Newest</a></li>
                            <li><a class="dropdown-item" href="#" onclick="sortOldest()">Oldest</a></li>
                            <li><a class="dropdown-item" href="#" onclick="sortLowestAvail()">Lowest available seats</a></li>
                           <li><a class="dropdown-item" href="#" onclick="sortHighestAvail()">Highest available seats </a></li>
                           <li><a class="dropdown-item" href="#" onclick="sortFavourite()">My Favourite</a></li>
                            <li><a class="dropdown-item" href="#" onclick="sortDeadline()">Registration Deadline</a></li>
                        </ul>
                    </div>
                    </div>
                    <div>
                        <button class="border-0 bg-white ms-2"><img src="../CI-Imgs/grid.png" alt="" onclick="gridView()" style=""></button>
                        <button class="border-0 bg-white ms-2"><img src="../CI-Imgs/list.png" alt="" onclick="listView()" style=""></button>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row" id="gridview">
                
            </div>
        </div>
        <div class="container mt-3">
            <div class="row">
                <div class="col-12">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-center" id="paginations">
                        
                    </ul>
                </nav>
                </div>
            </div>
        </div>
        <script>
            function updateOutput(page=1) {
          var filter = document.getElementById("filter-input").value;
          var output = document.getElementById("gridview");
          var jsonData = @Html.Raw(ViewBag.JsonData);
          output.innerHTML = "";
            var pageSize = 6; // number of items per page
            var startIndex = (page - 1) * pageSize;
            var endIndex = startIndex + pageSize;

            var data = filter === "" ? jsonData : jsonData.filter(student => {
                return student.Title.toLowerCase().startsWith(filter.toLowerCase());
            });
            if (data.length === 0) {
                var divs = document.createElement("div");
                divs.innerHTML = `<partial name="NoMission"/>`;
                output.appendChild(divs);
             
            }
            var count = data.length;
            // get the paragraph element to display the count
            var countElement = document.getElementById("list-count");

             countElement.textContent =  count + " Missions";

            var pageData = data.slice(startIndex, endIndex);
            pageData.forEach(student=>{
                const enddate = student.EndDate;
                const endDate = new Date(enddate);
                const today = new Date();
                const isClosed = endDate < today;
                var divs = document.createElement("div");
                divs.classList.add("col-lg-4", "col-md-6", "col-sm-12", "allviews", "p-0");
                divs.innerHTML = `<div class="card cardview mx-auto position-relative" style="width: 20rem;">
                  <img src="${student.MediaPath}" alt="" class="card-image">
                  <div class="position-absolute d-flex location">
                      <img src="../CI-Imgs/pin.png" alt="" class="pins mt-1 ms-3">
                      <p style="color: white; font-size:12px;" class="ms-1">`+ student.City+ `</p>
                              
                    </div>
                            ${isClosed ? '<button class="closed-btn position-absolute" type="button">Closed</button>' : ''}
                  <div class="imgbadge1 bg-white text-center">
                      <p style="font-size:15px">`+student.Theme+`</p>
                  </div>
                  <div class="card-body">
                                  <h5>`+ student.Title + `</h5>
                                  <p>`+ student.Description + `</p>
                      <div class="desc1 d-flex">
                          <div>
                                          <p>`+ student.ShortDescription + `</p>
                          </div>
                          <div class="star d-flex ms-auto">
                              <img src="../CI-Imgs/selected-star.png" alt="">
                              <img src="../CI-Imgs/selected-star.png" alt="">
                              <img src="../CI-Imgs/selected-star.png" alt="">
                              <img src="../CI-Imgs/star.png" alt="">
                          </div>
                      </div>
                      <div class="bg-white datebadge1">
                                                      <p class="ms-2">From`+ student.StartDate.slice(0, 10) + ` until ` + student.EndDate.slice(0, 10) + `</p>
                      </div>
                      <hr>
                      <div class="desc2 d-flex">
                          <div class="seats d-flex">
                              <img src="../CI-Imgs/Seats-left.png" alt="">
                              <p>`+student.SeatsAvailable+`seats left</p>
                          </div>

                          ${student.MissionType==="goal"?`<div class="d-flex flex-row align-items-center" style="width:50%;margin-left:20px;">
                    <img src="../CI-Imgs/achieved.png" height="25px" width="25px" alt="" class="mb-3">

                    <div class="d-flex flex-column ms-2 ">
                        <div class="progress">
                                  <div id="one" class="progress-bar" style="background-color: #F88634 !important;width: 60%;" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" >
                                   
                                  </div>
                                </div>
                        <p class="seat">8000 achieved</p>
                    </div>
                    </div>`
                    : `<div class="hours d-flex ms-auto">
                                      <img src="../CI-Imgs/hours.png" alt="">
                                              <p>`+ student.EndDate.slice(0, 10) + `<br>Deadline</p>
                                  </div>`
                              }
                          
                      </div>
                      <hr style="margin-top: 30px;">
                      <div class="apply d-flex">
                          <a class="btn btn-outline-warning mx-auto" href="/Home/Volunteering_Mission?MissionId=`+student.MissionId+`">Apply<img src="../CI-Imgs/right-arrow.png" alt=""></a>
                      </div>
                  </div>
              </div>`;
              output.appendChild(divs);
            });
            var numPages = Math.ceil(data.length / pageSize);
            var pagination = document.getElementById("paginations");
            pagination.innerHTML = "";
            var prevLi = document.createElement("li");
            prevLi.classList.add("page-item");
            var prevLink = document.createElement("a");
            prevLink.classList.add("page-link");
            prevLink.href = "#";
            prevLink.innerText = "Previous";
            prevLink.onclick = function () {
                if (page > 0) {
                    updateOutput(page - 1);
                }
            }


            prevLi.appendChild(prevLink);
            pagination.appendChild(prevLi);


            for (var i = 1; i <= numPages; i++) {
                var li = document.createElement("li");
                li.classList.add("page-item");
                var a = document.createElement("a");
                a.classList.add("page-link");
                a.style.textDecoration="none";
                a.href = "#";
                a.innerText = i;
                a.onclick = function () {
                    updateOutput(this.innerText);
                }
                li.appendChild(a);
                pagination.appendChild(li);
                if (i === page) {
                    a.classList.add("active");
                } else {
                    a.classList.remove("active");
                }
            }

            var nextLi = document.createElement("li");
            nextLi.classList.add("page-item");
            var nextLink = document.createElement("a");
            nextLink.classList.add("page-link");
            nextLink.href = "#";
            nextLink.innerText = "Next";
            nextLink.onclick = function () {
                if (page <= numPages - 1) {
                    updateOutput(page + 1);
                }
            }
            nextLi.appendChild(nextLink);
pagination.appendChild(nextLi);




            // Highlight the current page
            var currentPage = document.querySelector("#pagination li a.active");
            if (currentPage) {
                currentPage.classList.remove("active");
            }
            var newCurrentPage = document.querySelector("#pagination li:nth-child(" + (page + 1) + ") a");
            if (newCurrentPage) {
                newCurrentPage.classList.add("active");
            }
        }

        updateOutput();

        // Bind the updateOutput function to the input event of the filter input box
        var filterInput = document.getElementById("filter-input");
        filterInput.addEventListener("input", function () {
            updateOutput(1); // Reset to the first page when the filter changes
        });



        //-----------------------------------sort newest--------------------------------------------
        function sortNewest(page = 1) {
            var filter = document.getElementById("filter-input").value;
            var output = document.getElementById("gridview");
            var jsonData = @Html.Raw(ViewBag.JsonData);
            output.innerHTML = "";
            var pageSize = 6; // number of items per page
            var startIndex = (page - 1) * pageSize;
            var endIndex = startIndex + pageSize;

            var data = filter === "" ? jsonData : jsonData.filter(student => {
                return student.Title.toLowerCase().startsWith(filter.toLowerCase());
            });
            data.sort((a,b)=>Date.parse(b.StartDate)-Date.parse(a.StartDate));

            var pageData = data.slice(startIndex, endIndex);
            pageData.forEach(student => {
                const enddate = student.EndDate;
                const endDate = new Date(enddate);
                const today = new Date();
                const isClosed = endDate < today;
                var divs = document.createElement("div");
                divs.classList.add("col-lg-4", "col-md-6", "col-sm-12", "allviews", "p-0");
                divs.innerHTML = `<div class="card cardview mx-auto position-relative" style="width: 20rem;">
                                  <img src="${student.MediaPath}" alt="" class="card-image">
                          <div class="position-absolute d-flex location">
                              <img src="../CI-Imgs/pin.png" alt="" class="pins mt-1 ms-3">
                              <p style="color: white; font-size:12px;" class="ms-1">`+ student.City + `</p>

                            </div>
                                    ${isClosed ? '<button class="closed-btn position-absolute" type="button">Closed</button>' : ''}
                          <div class="imgbadge1 bg-white text-center">
                              <p style="font-size:15px">`+ student.Theme + `</p>
                          </div>
                          <div class="card-body">
                                          <h5>`+ student.Title + `</h5>
                                          <p>`+ student.Description + `</p>
                              <div class="desc1 d-flex">
                                  <div>
                                                  <p>`+ student.ShortDescription + `</p>
                                  </div>
                                  <div class="star d-flex ms-auto">
                                      <img src="../CI-Imgs/selected-star.png" alt="">
                                      <img src="../CI-Imgs/selected-star.png" alt="">
                                      <img src="../CI-Imgs/selected-star.png" alt="">
                                      <img src="../CI-Imgs/star.png" alt="">
                                  </div>
                              </div>
                              <div class="bg-white datebadge1">
                                                              <p class="ms-2">From`+ student.StartDate.slice(0, 10) + ` until ` + student.EndDate.slice(0, 10) + `</p>
                              </div>
                              <hr>
                              <div class="desc2 d-flex">
                                  <div class="seats d-flex">
                                      <img src="../CI-Imgs/Seats-left.png" alt="">
                                              <p>`+ student.SeatsAvailable + `seats left</p>
                                  </div>

                                  ${student.MissionType === "goal" ? `<div class="d-flex flex-row align-items-center" style="width:50%;margin-left:20px;">
                            <img src="../CI-Imgs/achieved.png" height="25px" width="25px" alt="" class="mb-3">

                            <div class="d-flex flex-column ms-2 ">
                                <div class="progress">
                                          <div id="one" class="progress-bar" style="background-color: #F88634 !important;width: 60%;" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" >

                                          </div>
                                        </div>
                                <p class="seat">8000 achieved</p>
                            </div>
                            </div>`
                        : `<div class="hours d-flex ms-auto">
                                              <img src="../CI-Imgs/hours.png" alt="">
                                                      <p>`+ student.EndDate.slice(0, 10) + `<br>Deadline</p>
                                          </div>`
                    }

                              </div>
                              <hr style="margin-top: 30px;">
                              <div class="apply d-flex">
                                  <a asp-controller="Home" asp-action="Volunteering_Mission" class="btn btn-outline-warning mx-auto">Apply<img src="../CI-Imgs/right-arrow.png" alt=""></a>
                              </div>
                          </div>
                      </div>`;
                output.appendChild(divs);
            });
            var numPages = Math.ceil(data.length / pageSize);
            var pagination = document.getElementById("paginations");
            pagination.innerHTML = "";
            var prevLi = document.createElement("li");
            prevLi.classList.add("page-item");
            var prevLink = document.createElement("a");
            prevLink.classList.add("page-link");
            prevLink.href = "#";
            prevLink.innerText = "Previous";
            prevLink.onclick = function () {
                if (page > 0) {
                    sortNewest(page - 1);
                }
            }


            prevLi.appendChild(prevLink);
            pagination.appendChild(prevLi);


            for (var i = 1; i <= numPages; i++) {
                var li = document.createElement("li");
                li.classList.add("page-item");
                var a = document.createElement("a");
                a.classList.add("page-link");
                a.style.textDecoration = "none";
                a.href = "#";
                a.innerText = i;
                a.onclick = function () {
                    sortNewest(this.innerText);
                }
                li.appendChild(a);
                pagination.appendChild(li);
                if (i === page) {
                    a.classList.add("active");
                } else {
                    a.classList.remove("active");
                }
            }

            var nextLi = document.createElement("li");
            nextLi.classList.add("page-item");
            var nextLink = document.createElement("a");
            nextLink.classList.add("page-link");
            nextLink.href = "#";
            nextLink.innerText = "Next";
            nextLink.onclick = function () {
                if (page <= numPages - 1) {
                    sortNewest(page + 1);
                }
            }
            nextLi.appendChild(nextLink);
            pagination.appendChild(nextLi);




            // Highlight the current page
            var currentPage = document.querySelector("#pagination li a.active");
            if (currentPage) {
                currentPage.classList.remove("active");
            }
            var newCurrentPage = document.querySelector("#pagination li:nth-child(" + (page + 1) + ") a");
            if (newCurrentPage) {
                newCurrentPage.classList.add("active");
            }
        }


        //------------------------------------sortoldest--------------------------------------------------
        function sortOldest(page = 1) {
            var filter = document.getElementById("filter-input").value;
            var output = document.getElementById("gridview");
            var jsonData = @Html.Raw(ViewBag.JsonData);
            output.innerHTML = "";
            var pageSize = 6; // number of items per page
            var startIndex = (page - 1) * pageSize;
            var endIndex = startIndex + pageSize;

            var data = filter === "" ? jsonData : jsonData.filter(student => {
                return student.Title.toLowerCase().startsWith(filter.toLowerCase());
            });
            data.sort((a, b) => Date.parse(a.StartDate) - Date.parse(b.StartDate));

            var pageData = data.slice(startIndex, endIndex);
            pageData.forEach(student => {
                const enddate = student.EndDate;
                const endDate = new Date(enddate);
                const today = new Date();
                const isClosed = endDate < today;
                var divs = document.createElement("div");
                divs.classList.add("col-lg-4", "col-md-6", "col-sm-12", "allviews", "p-0");
                divs.innerHTML = `<div class="card cardview mx-auto position-relative" style="width: 20rem;">
                                          <img src="${student.MediaPath}" alt="" class="card-image">
                                  <div class="position-absolute d-flex location">
                                      <img src="../CI-Imgs/pin.png" alt="" class="pins mt-1 ms-3">
                                      <p style="color: white; font-size:12px;" class="ms-1">`+ student.City + `</p>

                                    </div>
                                            ${isClosed ? '<button class="closed-btn position-absolute" type="button">Closed</button>' : ''}
                                  <div class="imgbadge1 bg-white text-center">
                                      <p style="font-size:15px">`+ student.Theme + `</p>
                                  </div>
                                  <div class="card-body">
                                                  <h5>`+ student.Title + `</h5>
                                                  <p>`+ student.Description + `</p>
                                      <div class="desc1 d-flex">
                                          <div>
                                                          <p>`+ student.ShortDescription + `</p>
                                          </div>
                                          <div class="star d-flex ms-auto">
                                              <img src="../CI-Imgs/selected-star.png" alt="">
                                              <img src="../CI-Imgs/selected-star.png" alt="">
                                              <img src="../CI-Imgs/selected-star.png" alt="">
                                              <img src="../CI-Imgs/star.png" alt="">
                                          </div>
                                      </div>
                                      <div class="bg-white datebadge1">
                                                                      <p class="ms-2">From`+ student.StartDate.slice(0, 10) + ` until ` + student.EndDate.slice(0, 10) + `</p>
                                      </div>
                                      <hr>
                                      <div class="desc2 d-flex">
                                          <div class="seats d-flex">
                                              <img src="../CI-Imgs/Seats-left.png" alt="">
                                                      <p>`+ student.SeatsAvailable + `seats left</p>
                                          </div>

                                          ${student.MissionType === "goal" ? `<div class="d-flex flex-row align-items-center" style="width:50%;margin-left:20px;">
                                    <img src="../CI-Imgs/achieved.png" height="25px" width="25px" alt="" class="mb-3">

                                    <div class="d-flex flex-column ms-2 ">
                                        <div class="progress">
                                                  <div id="one" class="progress-bar" style="background-color: #F88634 !important;width: 60%;" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" >

                                                  </div>
                                                </div>
                                        <p class="seat">8000 achieved</p>
                                    </div>
                                    </div>`
                        : `<div class="hours d-flex ms-auto">
                                                      <img src="../CI-Imgs/hours.png" alt="">
                                                              <p>`+ student.EndDate.slice(0, 10) + `<br>Deadline</p>
                                                  </div>`
                    }

                                      </div>
                                      <hr style="margin-top: 30px;">
                                      <div class="apply d-flex">
                                          <a asp-controller="Home" asp-action="Volunteering_Mission" class="btn btn-outline-warning mx-auto">Apply<img src="../CI-Imgs/right-arrow.png" alt=""></a>
                                      </div>
                                  </div>
                              </div>`;
                output.appendChild(divs);
            });
            var numPages = Math.ceil(data.length / pageSize);
            var pagination = document.getElementById("paginations");
            pagination.innerHTML = "";
            var prevLi = document.createElement("li");
            prevLi.classList.add("page-item");
            var prevLink = document.createElement("a");
            prevLink.classList.add("page-link");
            prevLink.href = "#";
            prevLink.innerText = "Previous";
            prevLink.onclick = function () {
                if (page > 0) {
                    sortOldest(page - 1);
                }
            }


            prevLi.appendChild(prevLink);
            pagination.appendChild(prevLi);


            for (var i = 1; i <= numPages; i++) {
                var li = document.createElement("li");
                li.classList.add("page-item");
                var a = document.createElement("a");
                a.classList.add("page-link");
                a.style.textDecoration = "none";
                a.href = "#";
                a.innerText = i;
                a.onclick = function () {
                    sortOldest(this.innerText);
                }
                li.appendChild(a);
                pagination.appendChild(li);
                if (i === page) {
                    a.classList.add("active");
                } else {
                    a.classList.remove("active");
                }
            }

            var nextLi = document.createElement("li");
            nextLi.classList.add("page-item");
            var nextLink = document.createElement("a");
            nextLink.classList.add("page-link");
            nextLink.href = "#";
            nextLink.innerText = "Next";
            nextLink.onclick = function () {
                if (page <= numPages - 1) {
                    sortOldest(page + 1);
                }
            }
            nextLi.appendChild(nextLink);
            pagination.appendChild(nextLi);




            // Highlight the current page
            var currentPage = document.querySelector("#pagination li a.active");
            if (currentPage) {
                currentPage.classList.remove("active");
            }
            var newCurrentPage = document.querySelector("#pagination li:nth-child(" + (page + 1) + ") a");
            if (newCurrentPage) {
                newCurrentPage.classList.add("active");
            }
        }


        //-----------------------------sort Lowest available seats-------------------------

        function sortLowestAvail(page = 1) {
            var filter = document.getElementById("filter-input").value;
            var output = document.getElementById("gridview");
            var jsonData = @Html.Raw(ViewBag.JsonData);
            output.innerHTML = "";
            var pageSize = 6; // number of items per page
            var startIndex = (page - 1) * pageSize;
            var endIndex = startIndex + pageSize;

            var data = filter === "" ? jsonData : jsonData.filter(student => {
                return student.Title.toLowerCase().startsWith(filter.toLowerCase());
            });
            data.sort((a, b) => a.SeatsAvailable - b.SeatsAvailable);

            var pageData = data.slice(startIndex, endIndex);
            pageData.forEach(student => {
                const enddate = student.EndDate;
                const endDate = new Date(enddate);
                const today = new Date();
                const isClosed = endDate < today;
                var divs = document.createElement("div");
                divs.classList.add("col-lg-4", "col-md-6", "col-sm-12", "allviews", "p-0");
                divs.innerHTML = `<div class="card cardview mx-auto position-relative" style="width: 20rem;">
                                          <img src="${student.MediaPath}" alt="" class="card-image">
                                  <div class="position-absolute d-flex location">
                                      <img src="../CI-Imgs/pin.png" alt="" class="pins mt-1 ms-3">
                                      <p style="color: white; font-size:12px;" class="ms-1">`+ student.City + `</p>

                                    </div>
                                            ${isClosed ? '<button class="closed-btn position-absolute" type="button">Closed</button>' : ''}
                                  <div class="imgbadge1 bg-white text-center">
                                      <p style="font-size:15px">`+ student.Theme + `</p>
                                  </div>
                                  <div class="card-body">
                                                  <h5>`+ student.Title + `</h5>
                                                  <p>`+ student.Description + `</p>
                                      <div class="desc1 d-flex">
                                          <div>
                                                          <p>`+ student.ShortDescription + `</p>
                                          </div>
                                          <div class="star d-flex ms-auto">
                                              <img src="../CI-Imgs/selected-star.png" alt="">
                                              <img src="../CI-Imgs/selected-star.png" alt="">
                                              <img src="../CI-Imgs/selected-star.png" alt="">
                                              <img src="../CI-Imgs/star.png" alt="">
                                          </div>
                                      </div>
                                      <div class="bg-white datebadge1">
                                                                      <p class="ms-2">From`+ student.StartDate.slice(0, 10) + ` until ` + student.EndDate.slice(0, 10) + `</p>
                                      </div>
                                      <hr>
                                      <div class="desc2 d-flex">
                                          <div class="seats d-flex">
                                              <img src="../CI-Imgs/Seats-left.png" alt="">
                                                      <p>`+ student.SeatsAvailable + `seats left</p>
                                          </div>

                                          ${student.MissionType === "goal" ? `<div class="d-flex flex-row align-items-center" style="width:50%;margin-left:20px;">
                                    <img src="../CI-Imgs/achieved.png" height="25px" width="25px" alt="" class="mb-3">

                                    <div class="d-flex flex-column ms-2 ">
                                        <div class="progress">
                                                  <div id="one" class="progress-bar" style="background-color: #F88634 !important;width: 60%;" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" >

                                                  </div>
                                                </div>
                                        <p class="seat">8000 achieved</p>
                                    </div>
                                    </div>`
                        : `<div class="hours d-flex ms-auto">
                                                      <img src="../CI-Imgs/hours.png" alt="">
                                                              <p>`+ student.EndDate.slice(0, 10) + `<br>Deadline</p>
                                                  </div>`
                    }

                                      </div>
                                      <hr style="margin-top: 30px;">
                                      <div class="apply d-flex">
                                          <a asp-controller="Home" asp-action="Volunteering_Mission" class="btn btn-outline-warning mx-auto">Apply<img src="../CI-Imgs/right-arrow.png" alt=""></a>
                                      </div>
                                  </div>
                              </div>`;
                output.appendChild(divs);
            });
            var numPages = Math.ceil(data.length / pageSize);
            var pagination = document.getElementById("paginations");
            pagination.innerHTML = "";
            var prevLi = document.createElement("li");
            prevLi.classList.add("page-item");
            var prevLink = document.createElement("a");
            prevLink.classList.add("page-link");
            prevLink.href = "#";
            prevLink.innerText = "Previous";
            prevLink.onclick = function () {
                if (page > 0) {
                    sortLowestAvail(page - 1);
                }
            }


            prevLi.appendChild(prevLink);
            pagination.appendChild(prevLi);


            for (var i = 1; i <= numPages; i++) {
                var li = document.createElement("li");
                li.classList.add("page-item");
                var a = document.createElement("a");
                a.classList.add("page-link");
                a.style.textDecoration = "none";
                a.href = "#";
                a.innerText = i;
                a.onclick = function () {
                    sortLowestAvail(this.innerText);
                }
                li.appendChild(a);
                pagination.appendChild(li);
                if (i === page) {
                    a.classList.add("active");
                } else {
                    a.classList.remove("active");
                }
            }

            var nextLi = document.createElement("li");
            nextLi.classList.add("page-item");
            var nextLink = document.createElement("a");
            nextLink.classList.add("page-link");
            nextLink.href = "#";
            nextLink.innerText = "Next";
            nextLink.onclick = function () {
                if (page <= numPages - 1) {
                    sortLowestAvail(page + 1);
                }
            }
            nextLi.appendChild(nextLink);
            pagination.appendChild(nextLi);




            // Highlight the current page
            var currentPage = document.querySelector("#pagination li a.active");
            if (currentPage) {
                currentPage.classList.remove("active");
            }
            var newCurrentPage = document.querySelector("#pagination li:nth-child(" + (page + 1) + ") a");
            if (newCurrentPage) {
                newCurrentPage.classList.add("active");
            }
        }
        //---------------------------sort highest available seats-------------------------
        function sortHighestAvail(page = 1) {
            var filter = document.getElementById("filter-input").value;
            var output = document.getElementById("gridview");
            var jsonData = @Html.Raw(ViewBag.JsonData);
            output.innerHTML = "";
            var pageSize = 6; // number of items per page
            var startIndex = (page - 1) * pageSize;
            var endIndex = startIndex + pageSize;

            var data = filter === "" ? jsonData : jsonData.filter(student => {
                return student.Title.toLowerCase().startsWith(filter.toLowerCase());
            });
            data.sort((a, b) => b.SeatsAvailable - a.SeatsAvailable);

            var pageData = data.slice(startIndex, endIndex);
            pageData.forEach(student => {
                const enddate = student.EndDate;
                const endDate = new Date(enddate);
                const today = new Date();
                const isClosed = endDate < today;
                var divs = document.createElement("div");
                divs.classList.add("col-lg-4", "col-md-6", "col-sm-12", "allviews", "p-0");
                divs.innerHTML = `<div class="card cardview mx-auto position-relative" style="width: 20rem;">
                                          <img src="${student.MediaPath}" alt="" class="card-image">
                                  <div class="position-absolute d-flex location">
                                      <img src="../CI-Imgs/pin.png" alt="" class="pins mt-1 ms-3">
                                      <p style="color: white; font-size:12px;" class="ms-1">`+ student.City + `</p>

                                    </div>
                                            ${isClosed ? '<button class="closed-btn position-absolute" type="button">Closed</button>' : ''}
                                  <div class="imgbadge1 bg-white text-center">
                                      <p style="font-size:15px">`+ student.Theme + `</p>
                                  </div>
                                  <div class="card-body">
                                                  <h5>`+ student.Title + `</h5>
                                                  <p>`+ student.Description + `</p>
                                      <div class="desc1 d-flex">
                                          <div>
                                                          <p>`+ student.ShortDescription + `</p>
                                          </div>
                                          <div class="star d-flex ms-auto">
                                              <img src="../CI-Imgs/selected-star.png" alt="">
                                              <img src="../CI-Imgs/selected-star.png" alt="">
                                              <img src="../CI-Imgs/selected-star.png" alt="">
                                              <img src="../CI-Imgs/star.png" alt="">
                                          </div>
                                      </div>
                                      <div class="bg-white datebadge1">
                                                                      <p class="ms-2">From`+ student.StartDate.slice(0, 10) + ` until ` + student.EndDate.slice(0, 10) + `</p>
                                      </div>
                                      <hr>
                                      <div class="desc2 d-flex">
                                          <div class="seats d-flex">
                                              <img src="../CI-Imgs/Seats-left.png" alt="">
                                                      <p>`+ student.SeatsAvailable + `seats left</p>
                                          </div>

                                          ${student.MissionType === "goal" ? `<div class="d-flex flex-row align-items-center" style="width:50%;margin-left:20px;">
                                    <img src="../CI-Imgs/achieved.png" height="25px" width="25px" alt="" class="mb-3">

                                    <div class="d-flex flex-column ms-2 ">
                                        <div class="progress">
                                                  <div id="one" class="progress-bar" style="background-color: #F88634 !important;width: 60%;" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" >

                                                  </div>
                                                </div>
                                        <p class="seat">8000 achieved</p>
                                    </div>
                                    </div>`
                        : `<div class="hours d-flex ms-auto">
                                                      <img src="../CI-Imgs/hours.png" alt="">
                                                              <p>`+ student.EndDate.slice(0, 10) + `<br>Deadline</p>
                                                  </div>`
                    }

                                      </div>
                                      <hr style="margin-top: 30px;">
                                      <div class="apply d-flex">
                                          <a asp-controller="Home" asp-action="Volunteering_Mission" class="btn btn-outline-warning mx-auto">Apply<img src="../CI-Imgs/right-arrow.png" alt=""></a>
                                      </div>
                                  </div>
                              </div>`;
                output.appendChild(divs);
            });
            var numPages = Math.ceil(data.length / pageSize);
            var pagination = document.getElementById("paginations");
            pagination.innerHTML = "";
            var prevLi = document.createElement("li");
            prevLi.classList.add("page-item");
            var prevLink = document.createElement("a");
            prevLink.classList.add("page-link");
            prevLink.href = "#";
            prevLink.innerText = "Previous";
            prevLink.onclick = function () {
                if (page > 0) {
                   sortHighestAvail(page - 1);
                }
            }


            prevLi.appendChild(prevLink);
            pagination.appendChild(prevLi);


            for (var i = 1; i <= numPages; i++) {
                var li = document.createElement("li");
                li.classList.add("page-item");
                var a = document.createElement("a");
                a.classList.add("page-link");
                a.style.textDecoration = "none";
                a.href = "#";
                a.innerText = i;
                a.onclick = function () {
                    sortHighestAvail(this.innerText);
                }
                li.appendChild(a);
                pagination.appendChild(li);
                if (i === page) {
                    a.classList.add("active");
                } else {
                    a.classList.remove("active");
                }
            }

            var nextLi = document.createElement("li");
            nextLi.classList.add("page-item");
            var nextLink = document.createElement("a");
            nextLink.classList.add("page-link");
            nextLink.href = "#";
            nextLink.innerText = "Next";
            nextLink.onclick = function () {
                if (page <= numPages - 1) {
                    sortHighestAvail(page + 1);
                }
            }
            nextLi.appendChild(nextLink);
            pagination.appendChild(nextLi);




            // Highlight the current page
            var currentPage = document.querySelector("#pagination li a.active");
            if (currentPage) {
                currentPage.classList.remove("active");
            }
            var newCurrentPage = document.querySelector("#pagination li:nth-child(" + (page + 1) + ") a");
            if (newCurrentPage) {
                newCurrentPage.classList.add("active");
            }
        }

        //-----------------------------------------------------------------------------------------
        var element = document.getElementsByClassName("allviews");
        var img = document.getElementsByClassName("card-image");
        var card = document.getElementsByClassName("cardview");
        var imgBadge1 = document.getElementsByClassName("imgbadge1");
        var dataBadge1 = document.getElementsByClassName("datebadge1");
        var i;
        var j;

        document.addEventListener("DOMContentLoaded", function () {
            const cbs = document.querySelectorAll("input[type='checkbox']");
            const filtersSection = document.querySelector(".filtersection");
            const clearBtn = document.querySelector("#clearBtn");
            for (let k = 0; k < cbs.length; k++) {
                cbs[k].addEventListener("change", function () {
                    updateData(1,this.value)
                    if (this.checked) {
                        const li = document.createElement("li");
                        li.innerHTML = this.name + `<img src="../CI-Imgs/cancel.png" alt="" class="ms-2" >`;
                        li.id = this.value;
                        li.addEventListener("click", function () {
                            li.remove();
                            cbs[k].checked = false;
                        });
                        filtersSection.appendChild(li);
                    } else {
                        const lis = document.getElementById(this.value);
                          
                        lis.remove();
                    }
                });
            }
            clearBtn.addEventListener("click", function () {
                const lis = filtersSection.getElementsByTagName('li');
                for (let i = lis.length - 1; i >= 0; i--) {
                    lis[i].click();
                }
            });
        });

        function listView() {
            for (i = 0; i < element.length; i++) {
                img[i].style.width = "30%";
                card[i].style.width = "100%";
                element[i].classList.add("col-12");
                element[i].classList.remove("col-lg-4", "col-md-6", "col-sm-12");
                card[i].style.flexDirection = "row";
                imgBadge1[i].style.display = "none";
                dataBadge1[i].style.display = "none";
            }
        }
        function gridView() {
            for (j = 0; j < element.length; j++) {
                card[j].style.flexDirection = "column";
                element[j].classList.remove("col-12");
                element[j].classList.add("col-lg-4", "col-md-6", "col-sm-12");
                img[j].style.width = "100%";
                card[j].style.width = "20rem"
                imgBadge1[j].style.display = "block";
                dataBadge1[j].style.display = "block";
                imgBadge1[j].style.top = "176px"
            }
        }
        function updateData(page=1,value){
            var output = document.getElementById("gridview");
            var jsonData = @Html.Raw(ViewBag.JsonData);
            output.innerHTML = "";
            var pageSize = 6; // number of items per page
            var startIndex = (page - 1) * pageSize;
            var endIndex = startIndex + pageSize;
            var country=[];
            var city=[];
            var theme=[];
            var skill=[];
            $('input[type="checkbox"]').each(function () {
                if ($(this).is(':checked')) {
                    var value = $(this).val();
                    var group = $(this).closest('.dropdown-menu').prev('.bg-white').text().trim();
                    switch (group) {
                        case 'Country':
                            country.push(value);
                            break;
                        case 'City':
                            city.push(value);
                            break;
                        case 'Theme':
                            theme.push(value);
                            break;
                        case 'Skills':
                            skill.push(value);
                            break;
                    }
                }
            });
            var data = jsonData.filter(student => {
                return (city.includes(student.CityId.toString())) || (country.includes(student.CountryId.toString())) || (theme.includes(student.ThemeId.toString()));
            });
            var pageData = data.slice(startIndex, endIndex);
            pageData.forEach(student => {
                var divs = document.createElement("div");
                divs.classList.add("col-lg-4", "col-md-6", "col-sm-12", "allviews", "p-0");
                divs.innerHTML = `<div class="card cardview mx-auto position-relative" style="width: 20rem;">
                                  <img src="${student.MediaPath}" alt="" class="card-image">
                          <div class="position-absolute d-flex location">
                              <img src="../CI-Imgs/pin.png" alt="" class="pins mt-1 ms-3">
                              <p style="color: white; font-size:12px;" class="ms-1">`+ student.City + `</p>
                            </div>
                          <div class="imgbadge1 bg-white">
                              <p class="ms-4">`+ student.Theme + `</p>
                          </div>
                          <div class="card-body">
                                          <h5>`+ student.Title + `</h5>
                                          <p>`+ student.Description + `</p>
                              <div class="desc1 d-flex">
                                  <div>
                                                  <p>`+ student.ShortDescription + `</p>
                                  </div>
                                  <div class="star d-flex ms-auto">
                                      <img src="../CI-Imgs/selected-star.png" alt="">
                                      <img src="../CI-Imgs/selected-star.png" alt="">
                                      <img src="../CI-Imgs/selected-star.png" alt="">
                                      <img src="../CI-Imgs/star.png" alt="">
                                  </div>
                              </div>
                              <div class="bg-white datebadge1">
                                                              <p class="ms-2">From`+ student.StartDate.slice(0, 10) + ` until ` + student.EndDate.slice(0, 10) + `</p>
                              </div>
                              <hr>
                              <div class="desc2 d-flex">
                                  <div class="seats d-flex">
                                      <img src="../CI-Imgs/Seats-left.png" alt="">
                                      <p>10 seats left</p>
                                  </div>
                                  <div class="hours d-flex ms-auto">
                                      <img src="../CI-Imgs/hours.png" alt="">
                                              <p>`+ student.EndDate.slice(0, 10) + `<br>Deadline</p>
                                  </div>
                              </div>
                              <hr style="margin-top: 30px;">
                              <div class="apply d-flex">
                                  <a asp-controller="Home" asp-action="Volunteering_Mission" class="btn btn-outline-warning mx-auto">Apply<img src="../CI-Imgs/right-arrow.png" alt=""></a>
                              </div>
                          </div>
                      </div>`;
                output.appendChild(divs);
            });
            var numPages = Math.ceil(data.length / pageSize);
            var pagination = document.getElementById("paginations");
            pagination.innerHTML = "";
            for (var i = 1; i <= numPages; i++) {
                var li = document.createElement("li");
                li.classList.add("page-item");
                var a = document.createElement("a");
                a.classList.add("page-link")
                a.style.textDecoration = "none";
                a.href = "#";
                a.innerText = i;
                a.onclick = function () {
                    updateOutput(this.innerText);
                }
                li.appendChild(a);
                pagination.appendChild(li);
            }

            // Highlight the current page
            var currentPage = document.querySelector("#pagination li a.active");
            if (currentPage) {
                currentPage.classList.remove("active");
            }
            var newCurrentPage = document.querySelector("#pagination li:nth-child(" + (page + 1) + ") a");
            if (newCurrentPage) {
                newCurrentPage.classList.add("active");
            }
        }

        </script>
                
        <script src="../Bootstrap/js/bootstrap.bundle.min.js"></script>
        <script src="~/js/Landing.js"></script>
    </body>
    </html>  
    
    